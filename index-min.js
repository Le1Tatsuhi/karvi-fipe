const puppeteer=require("puppeteer"),fs=require("fs"),stringify=require("csv-stringify"),url="https://www.karvi.com.br/tabela-fipe/";let dados=[];(async()=>{const a=await puppeteer.launch({headless:!0}),t=await a.newPage();await t.goto(url);const e=await t.$$eval("article > ul > li > a",(a=>a.map((a=>a.href))));for(const a of e){await t.goto(a);const e=await t.$$eval("main > a",(a=>a.map((a=>a.href.replace(/[()]/g,"-").replace(/ /g,"-")))));for(const a of e){await t.goto(a);const e=await t.$$eval("section > div > main > a",(a=>a.map((a=>a.href))));for(const a of e){await t.goto(a);const e=await t.$$eval("section > div > main > a",(a=>a.map((a=>a.href))));for(const a of e){await t.goto(a),await t.waitForSelector("nav > ol");const e=a.split("/")[4],i=a.split("/")[5],o=a.split("/")[6],r=await t.$eval("article > div.mb-3.space-y-4 > h1",(a=>a.innerText.replace("Tabela Fipe ","")));await t.waitForSelector("section.mx-auto.sm\\:max-w-2xl > div.px-5 > div");const s={marca:e,carro:i,ano:o,versao:r,logoMarca:await t.$eval("article > div.mb-3.space-y-4 > div > span > img",(a=>"https://www.karvi.com.br/"+a.getAttribute("src"))),tabelaFipe:await t.$eval("div.px-5 > div > div > div:nth-child(1) > p",(a=>a.innerText.replace("Â ","")))};dados.push(s),fs.writeFileSync("dados.json",JSON.stringify(dados,null,2),"utf-8",(a=>{if(a)throw new Error("Erro ao gerar o JSON")}))}}}}await a.close()})();